---
title: "computational_musicology"
author: "Daria Koppes"
date: "8-2-2021"
output:
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: cosmo
---
### Introduction

PLEASE DO NOT SHOW THIS PORTFOLIO IN CLASS

The corpus consists of three of my own wrapped Spotify playlists, from the years 2018, 2019 and 2020. I chose this corpus because I want to see how the type of music i listened too has evolved over the last three years. Did it change much or did it stay the same? Can you tell looking at the kind of music I was listening to what kind of year I generally had. 2019 for example was a good year for me and 2020 a more harder year, is that reflected in the music? 

Comparison points would be artists and features of the songs like valence and energy. I expect some artists to come back each year because I have been listening to them for a while now, e.g Imagine Dragons. Also when I travel I tend to be listening to more foreign music, so I expect 2018 and 2019 to have more Spanish/Portuguese/French artists in them than 2020 for example. Iâ€™m unsure if my type of music has significantly changed over the past three years but I am curious to look into it. 

The strength of the corpus is that it contains a significant amount of representative songs and especially for 2019 and 2020 I recognize all the numbers in it. In 2019 I was also pretty obsessed with Billie Eilish so it is typical to see that 20 of the 100 songs in my wrapped playlist are by her. For 2018 however I notice that some songs in the wrapped playlist I have never listened to. I do not know how they got in my wrapped playlist. For example: Pastempomat sang by Dawid Pdsiadlo is a polish song and I am certain that I never listened to this song or any other polish song. I will keep these songs in the playlist to have the same number of songs in every playlist. 

```{r, echo=FALSE}
library(tidyverse)
library(spotifyr)
library(plotly)
library(compmus)
```


```{r, echo=FALSE}
eighteen <- get_playlist_audio_features("", "37i9dQZF1EjuRTGXCnqj3q")
nineteen <- get_playlist_audio_features("", "37i9dQZF1Ethn3c8yyjsG9")
twenty <- get_playlist_audio_features("", "37i9dQZF1EM1eb9t3OIKaB")
billie <- get_playlist_audio_features("", "7L8fVkNZIHQ38k0hkcJkVo")
```

```{r, echo=FALSE}
combined <-
  bind_rows(
    eighteen %>% mutate(category = "Wrapped playlist 2018"),
    nineteen %>% mutate(category = "Wrapped playlist 2019"),
    twenty %>% mutate(category = "Wrapped playlist 2020")
  )

billie <-
  bind_rows(
        nineteen %>% mutate(category = "Wrapped playlist 2019"),
    billie %>% mutate(category = "Billie Eilish")
  )

```

### Week 2: The first visualisations 

#### plot 1

```{r, fig.align='center'}
histogram <- combined %>%
  ggplot(aes(x = energy, y=..density..)) +
  geom_histogram(binwidth = 0.1, col="grey", fill = "#0088cc") +
  geom_density() +
  facet_wrap(~category) +
  scale_colour_brewer(        # Use the Color Brewer to choose a palette.
    type = "qual",            # Qualitative set.
    palette = "Paired"        # Name of the palette is 'Paired'.
  ) +
  theme_light() +
  scale_x_continuous(         # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1),
    minor_breaks = NULL       # Remove 'minor' grid-lines.
  ) +
  theme( 
  axis.text = element_text(size = rel(0.95)), 
  strip.background = element_rect(fill="#008ae6", size=1.5, linetype="solid"),
  strip.text = element_text(size = 12),
  plot.title = element_text(size=12, 
    margin = margin(10, 0, 10, 0), hjust = 0.5)
) +
    labs(                      
    x = "Energy",
    y = "Density",
    colour = element_blank()
  ) +
    ggtitle("The density of songs filtered by energy over the years") 

histogram
```

> To start looking at the differences in music throughout the year and focussing on the mood of the songs i started with a histogram comparing the energy of the songs over the three years. To my surprise the year 2019 is actually the year with the lowest amount of high energy songs. As i said in the introduction 2019 was a good year for me and i was wondering if that would show in the type of music. Maybe because it was a good year i did not need high energy music to cheer me up but could listen to more low-energy songs and that could explain the density being lower in 2019 for high energy songs in comparison to 2020 and 2018. 


#### plot 2

```{r, fig.align='center', fig.width=7}
scatterplotyears <- combined %>%
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) %>%
  ggplot(                     # Set up the plot.
    aes(
      x = valence,
      y = energy,
      colour = mode
    )
  ) +
  geom_point(size = 2) +              # Scatter plot.   
  
  facet_grid(.~category) +     # Separate charts per playlist.
  scale_x_continuous(         # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.5, 1),   # Use grid-lines for quadrants only.
    minor_breaks = NULL       # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(         # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.5, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(        # Use the Color Brewer to choose a palette.
    type = "qual",            # Qualitative set.
    palette = "Paired"        # Name of the palette is 'Paired'.
  ) +
  
  theme_light() +             # Use a simpler theme.
  labs(                       # Make the titles nice.
    x = "Valence",
    y = "Energy",
    colour = element_blank()
  ) +
  theme( 
  axis.text = element_text(size = rel(0.95)), 
  strip.background = element_rect(fill="#008ae6", size=1.5, linetype="solid"),
  strip.text = element_text(size = 12),
  plot.title = element_text(size=12, 
    margin = margin(10, 0, 10, 0), hjust = 0.5), 
  legend.key = element_rect(fill = "#e7e7e4"),
  legend.position = "none"
) + 
  annotate("text", x = 0.1, y = 0.05, 
           label = "Sad" , color="black", alpha = 0.7, fontface="bold") + 
  annotate("text", x = 0.1, y = 0.95, 
           label = "Angry" , color="black", alpha = 0.7, fontface="bold") +
  annotate("text", x = 0.9, y = 0.05, 
           label = "Calm" , color="black",alpha = 0.7, fontface="bold") + 
  annotate("text", x = 0.9, y = 0.95, 
           label = "Happy" , color="black", alpha = 0.7, fontface="bold") +
  ggtitle("The mood of the songs in the different wrapped playlists") +
    geom_hline(yintercept=0.5, linetype="dashed", color = "orange") +
  geom_vline(xintercept = 0.5, linetype="dashed", 
                color = "orange")

scatterplotyears
```

***

An interesting find already is that there are not much calm songs in my Wrapped playlists, although i even have a separate playlist called 'calm' where i listen to all the time. Maybe my perception of calm song is different than that of spotify. 


### A scatterplot with the energy on the y axis and valence on the x so the mood of the songs can be compared. 

```{r, echo=FALSE}
scatterplotyears <- combined %>%
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) %>%
  ggplot(                     # Set up the plot.
    aes(
      x = valence,
      y = energy,
      colour = mode
    )
  ) +
  geom_point(size = 2) +              # Scatter plot.   
  
  facet_wrap(~category) +     # Separate charts per playlist.
  scale_x_continuous(         # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.5, 1),   # Use grid-lines for quadrants only.
    minor_breaks = NULL       # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(         # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.5, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(        # Use the Color Brewer to choose a palette.
    type = "qual",            # Qualitative set.
    palette = "Paired"        # Name of the palette is 'Paired'.
  ) +
  
  theme_light() +             # Use a simpler theme.
  labs(                       # Make the titles nice.
    x = "Valence",
    y = "Energy",
    colour = element_blank()
  ) +
  theme( 
  axis.text = element_text(size = rel(0.95)), 
  strip.background = element_rect(fill="#008ae6", size=1.5, linetype="solid"),
  strip.text = element_text(size = 12),
  plot.title = element_text(size=12, 
    margin = margin(10, 0, 10, 0), hjust = 0.5), 
  legend.key = element_rect(fill = "#e7e7e4"),
  legend.position = "none"
) + 
  annotate("text", x = 0.1, y = 0.05, 
           label = "Sad" , color="black", alpha = 0.7, fontface="bold") + 
  annotate("text", x = 0.1, y = 0.95, 
           label = "Angry" , color="black", alpha = 0.7, fontface="bold") +
  annotate("text", x = 0.9, y = 0.05, 
           label = "Calm" , color="black",alpha = 0.7, fontface="bold") + 
  annotate("text", x = 0.9, y = 0.95, 
           label = "Happy" , color="black", alpha = 0.7, fontface="bold") +
  ggtitle("The mood of the songs in the different wrapped playlists") +
    geom_hline(yintercept=0.5, linetype="dashed", color = "orange") +
  geom_vline(xintercept = 0.5, linetype="dashed", 
                color = "orange")

scatterplotyears
```

***

An interesting find already is that there are not much calm songs in my Wrapped playlists, although i even have a separate playlist called 'calm' where i listen to all the time. Maybe my perception of calm song is different than that of spotify. 

### In depth visualisation of Billie Eilish

```{r}
scatterplotbillie <- billie %>%
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) %>%
  ggplot(                     # Set up the plot.
    aes(
      x = valence,
      y = energy,
      colour = mode
    )
  ) +
  geom_point(size = 2) +              # Scatter plot.   
  
  facet_wrap(~category) +     # Separate charts per playlist.
  scale_x_continuous(         # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.5, 1),   # Use grid-lines for quadrants only.
    minor_breaks = NULL       # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(         # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.5, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(        # Use the Color Brewer to choose a palette.
    type = "qual",            # Qualitative set.
    palette = "Paired"        # Name of the palette is 'Paired'.
  ) +
  
  theme_light() +             # Use a simpler theme.
  labs(                       # Make the titles nice.
    x = "Valence",
    y = "Energy",
    colour = element_blank()
  ) +
  theme( 
  axis.text = element_text(size = rel(0.95)), 
  strip.background = element_rect(fill="#008ae6", size=1.5, linetype="solid"),
  strip.text = element_text(size = 12),
  plot.title = element_text(size=12, 
    margin = margin(10, 0, 10, 0), hjust = 0.5), 
  legend.key = element_rect(fill = "#e7e7e4")
) + 
  annotate("text", x = 0.1, y = 0.05, 
           label = "Sad" , color="black", alpha = 0.7, fontface="bold") + 
  annotate("text", x = 0.1, y = 0.95, 
           label = "Angry" , color="black", alpha = 0.7, fontface="bold") +
  annotate("text", x = 0.9, y = 0.05, 
           label = "Calm" , color="black",alpha = 0.7, fontface="bold") + 
  annotate("text", x = 0.9, y = 0.95, 
           label = "Happy" , color="black", alpha = 0.7, fontface="bold") +
  ggtitle("Comparing the mood of Billie Eilish with the mood of playlist wrapped 2019") +
  geom_hline(yintercept=0.5, linetype="dashed", color = "orange") +
  geom_vline(xintercept = 0.5, linetype="dashed", 
                color = "orange")

ggplotly(scatterplotbillie)
```

*** 

I also wanted to see how much the influence of Billie Eilish is on the wrapped playlist of 2019 because 20 numbers are from her. That is shown in the scatter plot below. As expected most of her songs fall under the category 'sad'. 